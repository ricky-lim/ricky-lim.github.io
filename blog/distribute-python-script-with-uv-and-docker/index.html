<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="icon" type="image/x-icon" href="../../static/favicon.ico">
  <link rel="apple-touch-icon" href="../../static/favicon.png">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../../static/style.css">
  <link rel="stylesheet" href="../../static/search.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=0.6, user-scalable=no">

  <title>Distribute Python Script with UV and Docker ‚Äî kutubuku</title>

  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>

  
</head>
<body>
  <header>
    <nav class="navbar">
      <div class="container-fluid">
        <div class="d-flex w-100 align-items-center justify-content-between">
          <!-- Left side: Logo and Hamburger -->
          <div class="d-flex align-items-center">
            <!-- Hamburger button -->
            <button class="navbar-toggler me-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
              <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Brand/Logo -->
            <a class="navbar-brand d-flex align-items-center" href="../../">
              <img src="../../static/rlim.png"
                   alt="rlim"
                   class="logo-rlim me-2">
            </a>
          </div>

          <!-- Right side: Search Form (always visible) -->
          <div class="navbar-search-main w-50">
            <form class="search-form d-flex" action="../../search/" method="get">
              <div class="input-group">
                <input type="search"
                       class="form-control form-control-sm search-input"
                       name="q"
                       placeholder="Search..."
                       aria-label="Search">
                <button class="btn btn-sm search-btn" type="submit" aria-label="Search">  <!-- Added btn-sm -->
                  <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                  </svg>
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <!-- Bootstrap Offcanvas -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasNavbarLabel">
        <img src="../../static/rlim.png"
             alt="rlim"
             class="logo-rlim me-2">
      </h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <ul class="navbar-nav flex-grow-1">
        <li class="nav-item">
          <a class="nav-link"
             href="../../">Welcome</a>
        </li>
        
          <li class="nav-item">
            <a class="nav-link active"
               href="../">Blog</a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link"
               href="../../search/">Search</a>
          </li>
        
          <li class="nav-item">
            <a class="nav-link"
               href="../../about/">About</a>
          </li>
        
      </ul>
    </div>
  </div>

  <div class="page">
    
  
  <div class="blog-post" data-pagefind-body>

  <div class="blog-post-header">
    
    <div class="blog-post-header-content">
      
        <h1 data-pagefind-meta="title">Distribute Python Script with UV and Docker</h1>
      
    </div>
  </div>

  <p class="meta">
    written by
    
      Ricky Lim
    
    on 2025-01-22
  </p>
  <h3>Note</h3>
<blockquote><p>This guide focuses on simplicity for single Python scripts but does not discourage creating Python packages for better maintenance.
You'll learn how to distribute Python scripts effectively, ensuring they are easy to run and share.</p>
</blockquote>
<p><br></p>
<p>In this guide, I will demonstrate how to share a Python script effectively.
We will utilize <strong>UV</strong> for dependency management and script execution, and <strong>Docker</strong> for seamless distribution.</p>
<p>We'll use a practical example: a weather forecast script, <a href="check_rain">check_rain</a> which helps determine if you need an umbrella.</p>
<p>This is how the script looks like:</p>
<p><img src="check-rain-output.png" alt="check_rain_output"></p>
<p>If you are not located in the Netherlands (NL) or Belgium (BE), the script will show an error message indicating that the location is not supported.
This ensures that the script only provides forecasts for supported regions.</p>
<p><img src="check-rain-output-error.png" alt="check_rain_output_error"></p>
<h2>Getting started with UV üöÄ</h2>
<p>Installation is straightforward on all major operating systems. Below are the instructions for Linux and macOS:</p>
<pre><code class="lang-bash">wget -qO- https://astral.sh/uv/install.sh | sh
</code></pre>
<h2>Script Overview üìú</h2>
<p>The <a href="check_rain">check_rain</a> script delivers local weather forecasts for the Netherlands and Belgium using Buienradar API.
It showcases the following features:</p>
<ul>
<li>üåç Automatic location detection (NL and BE)</li>
<li>üåßÔ∏è Real-time precipitation forecasts</li>
<li>‚òÇÔ∏è Clear umbrella recommendations</li>
</ul>
<pre><code class="lang-bash"># After downloading the script, ensure the script is executable
$ chmod +x check_rain
# Run the script
$ ./check_rain
</code></pre>
<p>The format of the script is as follows:</p>
<pre><code class="lang-python">#!/usr/bin/env -S uv run --script
# /// script
# requires-python = &quot;&gt;=3.12&quot;
# dependencies = [
#   &quot;requests&quot;,
#   &quot;rich&quot;,
# ]
# ///

# Your Python script here built collaboratively with your AI assistant
</code></pre>
<p>In the beginning of the script, we add the following header:</p>
<pre><code class="lang-python">#!/usr/bin/env -S uv run --script.
</code></pre>
<p>This nifty shebang line tells the system to use <code>uv</code> to run the script.
I learned this cool trick from Trey Hunner's blog:
<a href="https://treyhunner.com/2024/12/lazy-self-installing-python-scripts-with-uv/" target="_blank">Lazy Self-Installing Python Scripts with UV</a>.</p>
<p>After that, the script includes metadata using the following comment:</p>
<pre><code class="lang-python"># /// script
# requires-python = &quot;&gt;=3.12&quot;
# dependencies = [
#   &quot;requests&quot;,
#   &quot;rich&quot;,
# ]
# ///
</code></pre>
<p>This metadata is harnessed by UV to <strong><em>magically</em></strong> manage Python versions and dependencies for you.
It intelligently handles installation and caching, ensuring fast and reliable script execution every time you run it.</p>
<p>The rest of the script is a normal Python script üêç, which you can develop further with your favourite IDE or a simple text editor like VIM.</p>
<p>To format your script, use the following command:</p>
<pre><code class="lang-bash">uvx ruff format check_rain
</code></pre>
<p>Note: uvx is included with the UV installation and provides a convenient way to manage and run your Python scripts in isolated environments.</p>
<p>Now the script is ready to be distributed.</p>
<h2>System-wide Installation</h2>
<p>To make the script runnable from anywhere, place it in your <code>$HOME/.local/bin</code> directory.</p>
<pre><code>cp check_rain $HOME/.local/bin

# Ensure that the directory is recognized by your shell (.e.g zsh)
echo 'export PATH="$HOME/.local/bin:$PATH"' &gt;&gt; ~/.zshrc
</code></pre>
<p>Now the script is runnable from anywhere.</p>
<h2>Docker Distribution üê≥</h2>
<p>If installing <code>uv</code> is not an option, you can distribute the script using Docker.</p>
<p>The example below shows how to leverage <code>uv</code> in the Dockerfile to pre-install dependencies.</p>
<pre><code class="lang-bash">FROM python:3.12-slim-bookworm
COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

WORKDIR /app

COPY check_rain .

# Pre-install script dependencies
RUN sed -i &#39;1d&#39; check_rain &amp;&amp; \
    uv export --script check_rain --format requirements-txt &gt; requirements.txt &amp;&amp; \
    uv pip install --system -r requirements.txt

CMD [&quot;python&quot;, &quot;check_rain&quot;]
</code></pre>
<p>To simply package the script:</p>
<pre><code class="lang-bash"># Build the docker image
docker build -t check_rain .

# Save the image to a tar.gz file
docker save check_rain | gzip &gt; check_rain.tar.gz
</code></pre>
<p>Now the image is ready to be distributed as <code>check_rain.tar.gz</code>.</p>
<p>To load and run the Docker image from the tar.gz file:</p>
<pre><code class="lang-bash"># Load the docker image
gunzip -c check_rain.tar.gz | docker load

# Run the image
docker run -it check_rain
</code></pre>
<h2>Key Benefits üéØ</h2>
<ul>
<li><p><strong>Simplified Development and Execution with UV</strong>:
The script header specifies the required Python version and dependencies, ensuring consistency across different environments.</p>
</li>
<li><p><strong>Seamless Distribution with Docker</strong>:
By coupling UV with Docker, we can create a Docker image that includes all necessary dependencies.
This allows us to distribute our Python script as a self-contained package that can run anywhere Docker is supported.</p>
</li>
</ul>
<p>By leveraging these tools, you can ensure that your Python scripts are easy to develop, run, and distribute, providing a robust solution for script management and execution.</p>
<p>This guide is designed to help your Python script thrive by making it accessible, reliable, and easy to share with others.</p>


  </div>


  </div>

  <footer>
    &copy; Copyright 2025 by Ricky Lim.
    <br>
    Proudly built using <a class="lektor-link" href="https://www.getlektor.com/">Lektor</a>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  
</body>
</html>
